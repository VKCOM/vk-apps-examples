{"version":3,"sources":["App.js","index.js"],"names":["App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","image","text","lang","status","popout","canvasRef","React","createRef","recognize","bind","assertThisInitialized","imageChange","changeLanguage","e","_this2","setState","currentTarget","value","_this3","preventDefault","target","files","reader","FileReader","ctx","current","getContext","img","Image","onloadend","src","result","onload","canvas","width","height","drawImage","readAsDataURL","_this4","react_default","a","createElement","vkui","window","Tesseract","toDataURL","catch","err","console","error","then","data","finally","title","style","textAlign","display","alt","maxWidth","maxHeight","ref","textBlock","renderResultBlock","imageBlock","renderImageBlock","activePanel","id","top","placeholder","onChange","accept","size","before","camera_default","Component","connect","send","ReactDOM","render","src_App","document","getElementById"],"mappings":"mPA2JeA,cArJb,SAAAA,EAAYC,GAAO,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAL,IACjBE,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAH,GAAAQ,KAAAH,KAAMJ,KAEDQ,MAAQ,CACXC,MAAO,GACPC,KAAM,GACNC,KAAM,MACNC,OAAQ,QACRC,OAAQ,MAGVZ,EAAKa,UAAYC,IAAMC,YAEvBf,EAAKgB,UAAYhB,EAAKgB,UAAUC,KAAfhB,OAAAiB,EAAA,EAAAjB,QAAAiB,EAAA,EAAAjB,CAAAD,KACjBA,EAAKmB,YAAcnB,EAAKmB,YAAYF,KAAjBhB,OAAAiB,EAAA,EAAAjB,QAAAiB,EAAA,EAAAjB,CAAAD,KACnBA,EAAKoB,eAAiBpB,EAAKoB,eAAeH,KAApBhB,OAAAiB,EAAA,EAAAjB,QAAAiB,EAAA,EAAAjB,CAAAD,KAfLA,8EAkBJqB,GAAG,IAAAC,EAAAnB,KAChBA,KAAKoB,SAAS,CAACb,KAAMW,EAAEG,cAAcC,OAAQ,kBAAMH,EAAKN,kDAG9CK,GAAG,IAAAK,EAAAvB,KAGb,GAFAkB,EAAEM,iBAEGN,EAAEO,OAAOC,OAAUR,EAAEO,OAAOC,MAAM,GAAvC,CAIA,IAAIrB,EAAQa,EAAEO,OAAOC,MAAM,GACvBC,EAAS,IAAIC,WAEbC,EAAM7B,KAAKU,UAAUoB,QAAQC,WAAW,MACxCC,EAAM,IAAIC,MAEdN,EAAOO,UAAY,WACjBF,EAAIG,IAAMR,EAAOS,QAGnBJ,EAAIK,OAAS,WAEXR,EAAIS,OAAOC,MAAQP,EAAIO,MACvBV,EAAIS,OAAOE,OAASR,EAAIQ,OAExBX,EAAIY,UAAUT,EAAK,EAAG,EAClBH,EAAIS,OAAOC,MAAOV,EAAIS,OAAOE,QAGjCjB,EAAKH,SAAS,CACZf,MAAOwB,GACN,kBAAMN,EAAKV,eAIhBc,EAAOe,cAAcrC,wCAGX,IAAAsC,EAAA3C,KACLA,KAAKI,MAAMC,OAAUL,KAAKI,MAAMG,OAIrCP,KAAKoB,SAAS,CACZX,OAAQmC,EAAAC,EAAAC,cAACC,EAAA,cAAD,MACRvC,OAAQ,WACRF,KAAM,KAGR0C,OAAOC,UAAUpC,UAAUb,KAAKI,MAAMC,MAAMiC,OAAOY,YAAa,CAC5D3C,KAAMP,KAAKI,MAAMG,OAElB4C,MAAM,SAAAC,GAAG,OAAIC,QAAQC,MAAMF,KAC3BG,KAAK,SAAAC,GACJb,EAAKvB,SAAS,CACZd,KAAMkD,EAAKlD,SAGdmD,QAAQ,WACPd,EAAKvB,SAAS,CACZX,OAAQ,KACRD,OAAQ,4DAMd,IAAI4B,EAASpC,KAAKI,MAAME,KAKxB,OAJKN,KAAKI,MAAME,MAA8B,aAAtBN,KAAKI,MAAMI,SACjC4B,EAAS,8TAGNA,EAKHQ,EAAAC,EAAAC,cAACC,EAAA,MAAD,CAAOW,MAAM,kCACXd,EAAAC,EAAAC,cAACC,EAAA,IAAD,KAAMX,IALD,8CAWT,OAAQQ,EAAAC,EAAAC,cAACC,EAAA,MAAD,CAAOW,MAAM,sEAAb,IAA4Bd,EAAAC,EAAAC,cAACC,EAAA,IAAD,CAAKY,MAAO,CAC9CC,UAAW,WAEXhB,EAAAC,EAAAC,cAAA,OAAKa,MAAO,CAACE,QAAW7D,KAAKI,MAAMC,MAAiB,GAAT,SACzCuC,EAAAC,EAAAC,cAAA,UAAQgB,IAAI,qEAAcH,MAAO,CAC/BI,SAAU,OACVC,UAAW,QACVC,IAAKjE,KAAKU,aAEfkC,EAAAC,EAAAC,cAAA,OAAKa,MAAO,CAACE,QAAU7D,KAAKI,MAAMC,MAAQ,OAAS,KAAnD,qTAOF,IAAI6D,EAAYlE,KAAKmE,oBACjBC,EAAapE,KAAKqE,mBAGtB,OACEzB,EAAAC,EAAAC,cAACC,EAAA,KAAD,CAAMtC,OAAQT,KAAKI,MAAMK,OAAQ6D,YAAY,cAC3C1B,EAAAC,EAAAC,cAACC,EAAA,MAAD,CAAOwB,GAAG,cACR3B,EAAAC,EAAAC,cAACC,EAAA,YAAD,4HACCqB,EACAF,EACDtB,EAAAC,EAAAC,cAACC,EAAA,MAAD,CAAOW,MAAM,0DACXd,EAAAC,EAAAC,cAACC,EAAA,WAAD,KACEH,EAAAC,EAAAC,cAACC,EAAA,OAAD,CAAQyB,IAAI,2BAAOhE,OAAQR,KAAKI,MAAMG,KAAO,QAAU,QAASkE,YAAY,4EACpEnD,MAAOtB,KAAKI,MAAMG,KAAMmE,SAAU1E,KAAKiB,gBAC7C2B,EAAAC,EAAAC,cAAA,UAAQxB,MAAM,OAAd,gEACAsB,EAAAC,EAAAC,cAAA,UAAQxB,MAAM,OAAd,+CAEFsB,EAAAC,EAAAC,cAACC,EAAA,KAAD,CAAMyB,IAAI,qJAA6BG,OAAO,UAAUC,KAAK,KAAKC,OAAQjC,EAAAC,EAAAC,cAACgC,EAAAjC,EAAD,MACpE6B,SAAU1E,KAAKgB,aADrB,oGAzIIL,IAAMoE,WCGxBC,IAAQC,KAAK,eAAgB,IAE7BC,IAASC,OAAOvC,EAAAC,EAAAC,cAACsC,EAAD,MAASC,SAASC,eAAe","file":"static/js/main.9abadc80.chunk.js","sourcesContent":["import React from 'react';\nimport {Div, File, FormLayout, Group, Panel, PanelHeader, ScreenSpinner, Select, View} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Icon24Camera from '@vkontakte/icons/dist/24/camera';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      image: '',\n      text: '',\n      lang: 'rus',\n      status: 'ready',\n      popout: null,\n    };\n\n    this.canvasRef = React.createRef();\n\n    this.recognize = this.recognize.bind(this);\n    this.imageChange = this.imageChange.bind(this);\n    this.changeLanguage = this.changeLanguage.bind(this);\n  }\n\n  changeLanguage(e) {\n    this.setState({lang: e.currentTarget.value}, () => this.recognize());\n  }\n\n  imageChange(e) {\n    e.preventDefault();\n\n    if (!e.target.files || !e.target.files[0]) {\n      return;\n    }\n\n    let image = e.target.files[0];\n    let reader = new FileReader();\n\n    let ctx = this.canvasRef.current.getContext(\"2d\");\n    let img = new Image();\n\n    reader.onloadend = () => {\n      img.src = reader.result;\n    };\n\n    img.onload = () => {\n      // scale canvas to image\n      ctx.canvas.width = img.width;\n      ctx.canvas.height = img.height;\n      // draw image\n      ctx.drawImage(img, 0, 0\n        , ctx.canvas.width, ctx.canvas.height\n      );\n\n      this.setState({\n        image: ctx,\n      }, () => this.recognize());\n    };\n\n\n    reader.readAsDataURL(image);\n  }\n\n  recognize() {\n    if (!this.state.image || !this.state.lang) {\n      return;\n    }\n\n    this.setState({\n      popout: <ScreenSpinner/>,\n      status: 'progress',\n      text: ''\n    });\n\n    window.Tesseract.recognize(this.state.image.canvas.toDataURL(), {\n        lang: this.state.lang\n      })\n      .catch(err => console.error(err))\n      .then(data => {\n        this.setState({\n          text: data.text\n        });\n      })\n      .finally(() => {\n        this.setState({\n          popout: null,\n          status: 'finished'\n        })\n      })\n  }\n\n  renderResultBlock() {\n    let result = this.state.text;\n    if (!this.state.text && this.state.status === 'finished') {\n      result = '–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–µ–∫—Å—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.';\n    }\n\n    if (!result) {\n      return '';\n    }\n\n    return (\n      <Group title=\"–¢–µ–∫—Å—Ç\">\n        <Div>{result}</Div>\n      </Group>\n    );\n  }\n\n  renderImageBlock() {\n    return (<Group title=\"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\"> <Div style={{\n      textAlign: 'center',\n    }}>\n      <div style={{display: (!this.state.image ? 'none' : '')}}>\n        <canvas alt=\"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\" style={{\n          maxWidth: '100%',\n          maxHeight: '100%',\n        }} ref={this.canvasRef}></canvas>\n      </div>\n      <div style={{display: (this.state.image ? 'none' : '')}}>\n        –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ üì∑!\n      </div>\n    </Div></Group>);\n  }\n\n  render() {\n    let textBlock = this.renderResultBlock();\n    let imageBlock = this.renderImageBlock();\n\n\n    return (\n      <View popout={this.state.popout} activePanel='main_panel'>\n        <Panel id='main_panel'>\n          <PanelHeader>–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞</PanelHeader>\n          {imageBlock}\n          {textBlock}\n          <Group title=\"–ù–∞—Å—Ç—Ä–æ–π–∫–∏\">\n            <FormLayout>\n              <Select top=\"–Ø–∑—ã–∫\" status={this.state.lang ? 'valid' : 'error'} placeholder=\"–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫\"\n                      value={this.state.lang} onChange={this.changeLanguage}>\n                <option value=\"eng\">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>\n                <option value=\"rus\">–†—É—Å—Å–∫–∏–π</option>\n              </Select>\n              <File top=\"–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\" accept=\"image/*\" size=\"xl\" before={<Icon24Camera/>}\n                    onChange={this.imageChange}>\n                –û—Ç–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é\n              </File>\n            </FormLayout>\n          </Group>\n\n        </Panel>\n      </View>\n    );\n  }\n}\n\nexport default App;\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vkui-connect';\nimport App from './App';\n\n// Init VK App\nconnect.send('VKWebAppInit', {});\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}