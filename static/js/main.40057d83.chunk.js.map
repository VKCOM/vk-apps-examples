{"version":3,"sources":["App.js","index.js"],"names":["App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","image","text","lang","status","popout","recognize","bind","assertThisInitialized","imageChange","changeLanguage","e","_this2","setState","currentTarget","value","_this3","preventDefault","target","files","options","canvas","file","loadImage","parseMetaData","data","exif","orientation","get","img","type","toDataURL","_this4","react_default","a","createElement","vkui","window","Tesseract","catch","err","console","error","then","finally","result","title","top","style","textAlign","display","alt","maxWidth","maxHeight","src","textBlock","renderResultBlock","imageBlock","renderImageBlock","activePanel","id","placeholder","onChange","accept","size","before","camera_default","React","Component","connect","send","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.40057d83.chunk.js","sourcesContent":["import React from 'react';\nimport {Div, File, FormLayout, Group, Panel, PanelHeader, ScreenSpinner, Select, Textarea, View} from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\nimport Icon24Camera from '@vkontakte/icons/dist/24/camera';\nimport loadImage from 'blueimp-load-image';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      image: '',\n      text: '',\n      lang: 'rus',\n      status: 'ready',\n      popout: null,\n    };\n\n    this.recognize = this.recognize.bind(this);\n    this.imageChange = this.imageChange.bind(this);\n    this.changeLanguage = this.changeLanguage.bind(this);\n  }\n\n  changeLanguage(e) {\n    this.setState({lang: e.currentTarget.value}, () => this.recognize());\n  }\n\n  imageChange(e) {\n    e.preventDefault();\n\n    if (!e.target.files || !e.target.files[0]) {\n      return;\n    }\n\n    let options = {\n      canvas: true\n    };\n    let file = e.target.files[0];\n    loadImage.parseMetaData(file, (data) => {\n      if (data.exif) {\n        options.orientation = data.exif.get('Orientation');\n      }\n      loadImage(file, (img) => {\n\n        if (img.type === 'error') {\n          // clearUpload();\n          // ErrorFactory.setErrorMessage('', 'Please try another image.');\n        } else {\n          this.setState({\n            image: img.toDataURL(),\n          }, () => this.recognize());\n        }\n\n      }, options);\n    });\n  }\n\n  recognize() {\n    if (!this.state.image || !this.state.lang) {\n      return;\n    }\n\n    this.setState({\n      popout: <ScreenSpinner/>,\n      status: 'progress',\n      text: ''\n    });\n\n    window.Tesseract.recognize(this.state.image, {\n        lang: this.state.lang\n      })\n      .catch(err => console.error(err))\n      .then(data => {\n        this.setState({\n          text: data.text\n        });\n      })\n      .finally(() => {\n        this.setState({\n          popout: null,\n          status: 'finished'\n        })\n      })\n  }\n\n  renderResultBlock() {\n    let result = this.state.text;\n    if (!this.state.text && this.state.status === 'finished') {\n      result = '–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ç–µ–∫—Å—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.';\n    }\n\n    if (!result) {\n      return '';\n    }\n\n    return (\n      <Group title=\"–†–µ–∑—É–ª—å—Ç–∞—Ç\">\n        <FormLayout>\n          <Textarea top=\"–¢–µ–∫—Å—Ç\" value={result}/>\n        </FormLayout>\n      </Group>\n    );\n  }\n\n  renderImageBlock() {\n    return (<Group title=\"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\"> <Div style={{\n      textAlign: 'center',\n    }}>\n      <div style={{display: (!this.state.image ? 'none' : '')}}>\n        <img alt=\"–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\" style={{\n          maxWidth: '100%',\n          maxHeight: '100%',\n        }} src={this.state.image}/>\n      </div>\n      <div style={{display: (this.state.image ? 'none' : '')}}>\n        –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–æ–≤–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ üì∑!\n      </div>\n    </Div></Group>);\n  }\n\n  render() {\n    let textBlock = this.renderResultBlock();\n    let imageBlock = this.renderImageBlock();\n\n\n    return (\n      <View popout={this.state.popout} activePanel='main_panel'>\n        <Panel id='main_panel'>\n          <PanelHeader>–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞</PanelHeader>\n          {imageBlock}\n          {textBlock}\n          <Group title=\"–ù–∞—Å—Ç—Ä–æ–π–∫–∏\">\n            <FormLayout>\n              <Select top=\"–Ø–∑—ã–∫\" status={this.state.lang ? 'valid' : 'error'} placeholder=\"–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫\"\n                      value={this.state.lang} onChange={this.changeLanguage}>\n                <option value=\"eng\">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>\n                <option value=\"rus\">–†—É—Å—Å–∫–∏–π</option>\n              </Select>\n              <File top=\"–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ\" accept=\"image/*\" size=\"xl\" before={<Icon24Camera/>}\n                    onChange={this.imageChange}>\n                –û—Ç–∫—Ä—ã—Ç—å –≥–∞–ª–µ—Ä–µ—é\n              </File>\n            </FormLayout>\n          </Group>\n\n        </Panel>\n      </View>\n    );\n  }\n}\n\nexport default App;\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vkui-connect';\nimport App from './App';\n\n// Init VK App\nconnect.send('VKWebAppInit', {});\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}